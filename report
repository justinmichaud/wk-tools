#!/bin/bash
export GH_PAGER=cat
# Setup

SINCE_DATE=$(date -v-7d +%Y-%m-%d)
#SINCE_DATE=$(date -f '7 days ago' +%Y-%m-%d)
#SINCE_DATE=2024-12-13
REPO_FULL=$(gh repo view --json nameWithOwner --jq .nameWithOwner)
#USER=$(gh api user --jq .login)
echo "ðŸ“Š Weekly GitHub Activity Summary for @$USER in $REPO_FULL since $SINCE_DATE (Week $(date +"%V"))"
echo "ðŸ“… Date range: $SINCE_DATE â†’ $(date +%Y-%m-%d)"
echo "ðŸ“ Repository: $REPO_FULL"
echo ""
##########################
# âœ… PRs authored
##########################
echo "âœ… Pull Requests created:"
gh pr list --author "$USER" --search "created:>=$SINCE_DATE" --state all 
echo ""

echo "âœ… Pull Requests updated:"
gh pr list --author "$USER" --search "updated:>=$SINCE_DATE" --state all 
echo ""


##########################
# ðŸ” Reviews & Comments
##########################
echo "ðŸ” Reviews & Comments:"
total_comments=0

# Get PRs with review/comment counts
echo "PRs reviewed/commented:"
gh search prs --repo="$REPO_FULL" --commenter="$USER" --created=">=$SINCE_DATE" 
echo ""

